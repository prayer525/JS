
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no, address=no, email=no">
<title>MyKia :: License</title>
<style>
* {margin:0; padding:0;}
html, body {width:100%; height:100%;}
.lock {overflow:hidden;}
.slide-wrap {position:relative; width:100%; height:200px; overflow:hidden;}
.slide-wrap .slide {position:relative; width:100%; height:100%; overflow:hidden;}
.slide-wrap .slide li {position:absolute; top:0; left:0; width:100%; height:100%; z-index:1;}
.slide-wrap .slide li.red {background:red;}
.slide-wrap .slide li.blue {background:blue;}
.slide-wrap .slide li.green {background:green;}
.slide-wrap .slide li.current {z-index:3;}
.slide-wrap .slide li.next {z-index:2;}
.slide-wrap .slide li div {width:100%; height:100%; background:#fff;}
.slide-wrap a.btn-left-arrow {position:absolute; top:50%; left:10px; display:inline-block; z-index:4;}
.slide-wrap a.btn-right-arrow {position:absolute; top:50%; right:10px; display:inline-block; z-index:4;}
</style>
</head>
<body>
<!-- ========== Start ========== -->
<div class="slide-wrap">
    <ul class="slide">
        <li class="red"><div>page</div></li>
        <li class="blue">b</li>
        <li class="green">c</li>
    </ul>
    <a href="#" class="btn-left-arrow">left</a>
    <a href="#" class="btn-right-arrow">right</a>
</div>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p>30</p>
<p>31</p>
<p>32</p>
<p>33</p>
<p>34</p>
<p>35</p>
<p>36</p>
<p>37</p>
<p>38</p>
<p>39</p>
<p>40</p>
<p>41</p>
<p>42</p>
<p>43</p>
<p>44</p>
<p>45</p>
<p>46</p>
<p>47</p>
<p>48</p>
<p>49</p>
<p>50</p>
<p>51</p>
<p>52</p>
<p>53</p>
<p>54</p>
<p>55</p>
<p>56</p>
<p>57</p>
<p>58</p>
<p>59</p>
<p>60</p>
<p>61</p>
<p>62</p>
<p>63</p>
<p>64</p>
<p>65</p>
<p>66</p>
<p>67</p>
<p>68</p>
<p>69</p>
<p>70</p>
<p>71</p>
<p>72</p>
<p>73</p>
<p>74</p>
<p>75</p>
<p>76</p>
<p>77</p>
<p>78</p>
<p>79</p>
<p>80</p>
<p>81</p>
<p>82</p>
<p>83</p>
<p>84</p>
<p>85</p>
<p>86</p>
<p>87</p>
<p>88</p>
<p>89</p>
<p>90</p>
<p>91</p>
<p>92</p>
<p>93</p>
<p>94</p>
<p>95</p>
<p>96</p>
<p>97</p>
<p>98</p>
<p>99</p>
<p>100</p>
<!-- ========== //End ========== -->
</body>
<script type="text/javascript">
var slide = {
    init:function(_target, _op){
        _this = this;

        /*
            start, end, different position variable
        */
        _this.point = {
            xDown:null,
            yDown:null,
            xUp:null,
            yUp:null,
            xDiff:null,
            yDiff:null
        }

        // _target 아래에 있는 모든 list 를 선택
        _this.li = document.querySelectorAll(_target+' li');

        // 첫번째 list 에 class=current(z-index:3) 를 주어 리스트의 맨 앞으로 보낸다.
        _this.addClass(_this.li[0], 'current');

        // 두번째 list 에 class=next(z-index:2) 를 주어 맨 앞의 list가 좌우로 움직일 때 뒤에 보여지게 한다.
        _this.addClass(_this.li[1], 'next');

        // list 의 width 를 구해 저장한다. slide 속도 및 slide 종료 위치 지정에 사용된다.
        _this.liWidth = _this.li[0].offsetWidth;

        /*
            slide 속도에 영향 전체 넓이를 40 으로 나눈만큼 interval 에서 움직인다.
            나누는 숫자(40)가 작을수록 slide 속도가 빨라진다.
            후에 사용자로부터 입력 받아서 사용 가능하다.
        */
        _this.step = _this.liWidth / 100;

        /*
            slide animation 동작중 추가 이벤트를 막기 위한 변수.
            animation 이 시작할 때 true, 종료될 때 false 로 바뀌며,
            추가 이벤트(click, touchstart)가 발생할 때 체크 후 true 일 경우 return false 시킨다.
        */
        _this.animation = false;

        /*
            width:100% 의 slide 나 반응형 웹일 경우 넓이가 변경이되면
            slide의 넓이와 넓이에 따라 변화된 step size 를 변경해준다.
        */
        window.onresize = function(){
            _this.liWidth = _this.li[0].offsetWidth;
            _this.step = _this.liWidth / 100;
        }

        // slide list 의 length : 빈번하게 사용되는 값이라 변수에 저장해서 사용
        _this.length = _this.li.length;

        /*
            issue : touchmove, left/right animation 시 event.target 의 translate 의 위치값을 변경
                    - event target 이 li가 아니라 다른 자식노드 (li > div > span) 가 됐을 때
                    - event target의 translate 값이 변경 되어서 slide 에 에러 발생
            modify : 현재 가장 앞에 보여지고 있는 li의 index 번호를 저장.
                    event target 이 아닌 li[index] 로 slide animation 동작
        */
        _this.liIdx = 0;

        // 옵션이 있는경우 : 향후 옵션은 추가 가능
        if(_op){
            // pageArrow(좌우 화살표) 가 있으면
            if(_op.pageArrow){
                // 좌우 화살표에 event 등록
                _this.arrowEvent(_target);
            }
        }

        // ㅣㅑ
        _this.regEvt(_this.li)
    },

    /*
        list 에 event 등록 현재는 mobile & pc 를 동시에 등록.
        후에 해당 target device 에만 event 등록하게 변경
    */
    regEvt:function(_li){
        for(var i=0; i<_this.length; i++){
            // mobile, tablet device
            _li[i].addEventListener('touchstart', _this.fnTouchStart, false);
            _li[i].addEventListener('touchmove', _this.fnTouchMove, false);
            _li[i].addEventListener('touchend', _this.fnTouchEnd, false);

            // PC 
            _li[i].addEventListener('mousedown', _this.fnTouchStart, false);
            _li[i].addEventListener('mousemove', _this.fnTouchMove, false);
            _li[i].addEventListener('mouseup', _this.fnTouchEnd, false);

            // PC mouse pointer 가 list 를 벗어나는 경우 end event 로 간주
            _li[i].addEventListener('mouseleave', _this.fnTouchEnd, false);
        }
    },

    /*
        좌우 화살표 버튼의 event 등록
    */
    arrowEvent:function(_target){
        // 좌우 화살표 버튼의 사용 여부와 함께 좌우 화살표 버튼으로 사용할 className 도 받아서 사용 가능
        _this.leftArrow = document.querySelector(_target+' .btn-left-arrow');
        _this.rightArrow = document.querySelector(_target+' .btn-right-arrow');

        // left button event
        _this.leftArrow.addEventListener('click', _this.fnLeftArrow, false);
        _this.leftArrow.addEventListener('touchend', _this.fnLeftArrow, false);

        // right button event
        _this.rightArrow.addEventListener('click', _this.fnRightArrow, false);
        _this.rightArrow.addEventListener('touchend', _this.fnRightArrow, false);
    },

    /* touch start, mouse down */
    fnTouchStart:function(evt){
        // animation 동작 체크후 동작중이면 return
        if(_this.animation){
            return false;
        }

        // event type 설정 touch device 나 PC나 동일 이벤트 변수 사용 
        if(evt.type.indexOf('touch') > -1){
            evt = evt.touches[0];
        }

        // start position X, Y 좌표 저장
        _this.point.xDown = evt.clientX;
        _this.point.yDown = evt.clientY;
    },
    /* touch move, mouse move */
    fnTouchMove:function(evt){
        // 값이 없을 경우 return
        if ( ! _this.point.xDown || ! _this.point.yDown ) {
            return;
        }

        // event type 설정 touch device 나 PC나 동일 이벤트 변수 사용 
        if(evt.type.indexOf('touch') > -1){
            evt = evt.touches[0];
        }

        // slide 동작시 화면의 위 아래 슬라이드를 막기 위해 body 에 스타일 지정
        document.body.setAttribute('style','overflow:hidden;');

        // start , end position 의 차이를 구한다.
        _this.point.xDiff = evt.clientX - _this.point.xDown;
        _this.point.yDiff = evt.clientY - _this.point.yDown;

        if ( Math.abs( _this.point.xDiff ) > Math.abs( _this.point.yDiff ) ) {
            _this.li[_this.liIdx].style.webkitTransform = 'translate3d('+_this.point.xDiff+'px,0,0)';
        }
    },
    fnTouchEnd:function(evt){
        if(_this.point.xDiff > 100){
            _this.rightAni(_this.li[_this.liIdx], _this.point.xDiff);
        }else if(_this.point.xDiff < -100){
            _this.leftAni(_this.li[_this.liIdx], _this.point.xDiff);
        }else{
            _this.initAni(_this.li[_this.liIdx], _this.point.xDiff);
        }
        
        document.body.removeAttribute('style');

        _this.point = {
            xDown:null,
            yDown:null,
            xUp:null,
            yUp:null,
            xDiff:null,
            yDiff:null
        }
    },
    fnLeftArrow:function(e){
        e.preventDefault();

        if(_this.animation){
            return false;
        }

        for(var i = 0; i < _this.length; i++){
            if((_this.li[i].className).indexOf('current') > -1){
                _this.leftAni(_this.li[i], 0)
            }
        }
    },
    fnRightArrow:function(e){
        e.preventDefault();

        if(_this.animation){
            return false;
        }

        for(var i = 0; i < _this.length; i++){
            if((_this.li[i].className).indexOf('current') > -1){
                _this.rightAni(_this.li[i], 0)
            }
        }
    },
    initAni:function(_target, currentPoint){
        _this.animation = true;
        var leftInterval = setInterval(function(){
            if(currentPoint > 0){
                currentPoint-=3;
                if(currentPoint < 0){
                    currentPoint = 0;

                    clearInterval(leftInterval);

                    _this.animation = false;
                }
            }else{
                currentPoint+=3;
                if(currentPoint > 0){
                    currentPoint = 0;

                    clearInterval(leftInterval);

                    _this.animation = false;
                }
            }

            _target.style.webkitTransform = 'translate3d('+currentPoint+'px,0,0)';
        }, 10)
    },
    rightAni:function(_target, currentPoint){
        _this.animation = true;
        var leftInterval = setInterval(function(){
            if(currentPoint < _this.liWidth){
                currentPoint+=_this.step;
                _target.style.webkitTransform = 'translate3d('+currentPoint+'px,0,0)';
            }else{
                clearInterval(leftInterval);
                _this.elementInit(_target);
                _this.animation = false;
            }
        }, 2)
    },
    leftAni:function(_target, currentPoint){
        _this.animation = true;
        var leftInterval = setInterval(function(){
            if(currentPoint > -_this.liWidth){
                currentPoint-=_this.step;
                _target.style.webkitTransform = 'translate3d('+currentPoint+'px,0,0)';
            }else{
                clearInterval(leftInterval);
                _this.elementInit(_target);
                _this.animation = false;
            }
        }, 2)
    },
    addClass:function(_t, _cName){
        var _c = _t.getAttribute('class')
        if(_c != null){
            _t.setAttribute('class', _c + ' ' + _cName)
        }else{
            _t.setAttribute('class',  _cName)
        }
    },
    removeClass:function(_t, _cName){
        var _c = _t.getAttribute('class')
        _c = _c.replace(_cName, '').trim();
        _t.setAttribute('class',  _c);
    },
    elementInit:function(_target){
        var _index = null;
        for(var i = 0; i<_this.length; i++){
            if(_this.li[i] == _target){
                _index = i;
            }
        }
        _this.li[_index].removeAttribute('style');
        _this.removeClass(_this.li[_index], 'current')

        if(_index == _this.length-1){
            _this.removeClass(_this.li[0], 'next')
            _this.addClass(_this.li[0], 'current')
            _this.addClass(_this.li[1], 'next')
            _this.liIdx = 0;
        }else{
            _this.removeClass(_this.li[_index+1], 'next')
            _this.addClass(_this.li[_index+1], 'current')

            _this.liIdx = _index+1;

            if(_index == _this.length - 2){
                _this.addClass(_this.li[0], 'next')
            }else{
                _this.addClass(_this.li[_index+2], 'next')
            }
        }
    }
}

slide.init('.slide-wrap',{
    pageArrow:true // default false;
})


</script>
</html>