<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Zoom In/Out
  </h1>
</section>
<!-- Main content -->
<section class="content">
  <!-- Small boxes (Stat box) -->
  <div class="row">
    <style>
      div#zoomContents {
      border:1px solid #999;
      width:100%;
      height:100%;
      max-height:300px;
      overflow:hidden;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      }
      #target {
      background: white;
      }
    </style>
    <div id="zoomContents">
      <div id="target">
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
          <p>Zoom In/Out scale test</p>
      </div>
      <!-- UI for logging/debugging -->
    </div>
    <p>touch start point X : <span id="startAbsX"></span></p>
    <p>touch start point Y : <span id="startAbsY"></span></p>
    <p>touch move point X : <span id="moveAbsX"></span></p>
    <p>touch move point Y : <span id="moveAbsY"></span></p>
    <p>touch end point X : <span id="endAbsX"></span></p>
    <p>touch end point Y : <span id="endAbsY"></span></p>
  </div>
  <!-- /.row -->
</section>
<!-- /.content -->
<script type="text/javascript">
  var pinchZoom = {
    obj:{
      startAbsX:0,
      startAbsY:0,
      moveAbsX:0,
      moveAbsY:0,
      endAbsX:0,
      endAbsY:0,
      elWidth:0,
      elHeight:0,
      oldScale:1
    },
    el:null,
    init:function(t){
      pinchZoom.el = document.querySelector(t);

      pinchZoom.obj.elWidth = pinchZoom.el.parentNode.offsetWidth;
      pinchZoom.obj.elHeight = pinchZoom.el.parentNode.offsetHeight;
  
      pinchZoom.el.addEventListener('touchstart', pinchZoom.fnTouchStart, false);
      pinchZoom.el.addEventListener('touchmove', pinchZoom.fnTouchMove, false);
      pinchZoom.el.addEventListener('touchend', pinchZoom.fnTouchEnd, false);
      
    },
    fnTouchStart:function(evt){
      if(evt.touches.length == 2){
        pinchZoom.obj.startAbsX = Math.abs(evt.touches[0].clientX - evt.touches[1].clientX);
        pinchZoom.obj.startAbsY = Math.abs(evt.touches[0].clientY - evt.touches[1].clientY);
  
        document.getElementById('startAbsX').innerHTML = pinchZoom.obj.startAbsX;
        document.getElementById('startAbsY').innerHTML = pinchZoom.obj.startAbsY;
      }
    },
    fnTouchMove:function(evt){
      if(evt.touches.length == 2){
        pinchZoom.obj.moveAbsX = Math.abs(evt.touches[0].clientX - evt.touches[1].clientX);
        pinchZoom.obj.moveAbsY = Math.abs(evt.touches[0].clientY - evt.touches[1].clientY);

        pinchZoom.fnZoomScale();

        document.getElementById('moveAbsX').innerHTML = pinchZoom.obj.moveAbsX;
        document.getElementById('moveAbsY').innerHTML = pinchZoom.obj.moveAbsY;
      }
    },
    fnTouchEnd:function(evt){
        pinchZoom.obj.endAbsX = Math.abs(evt.touches[0].clientX - evt.touches[1].clientX);
        pinchZoom.obj.endAbsY = Math.abs(evt.touches[0].clientY - evt.touches[1].clientY);
  
        document.getElementById('endAbsX').innerHTML = pinchZoom.obj.endAbsX;
        document.getElementById('endAbsY').innerHTML = pinchZoom.obj.endAbsY;
    },
    fnZoomScale:function(){
      var scaleX = (pinchZoom.obj.moveAbsX - pinchZoom.obj.startAbsX) / pinchZoom.obj.elWidth;
      var scaleY = (pinchZoom.obj.moveAbsY - pinchZoom.obj.startAbsY) / pinchZoom.obj.elHeight;

      pinchZoom.obj.oldScale = pinchZoom.obj.oldScale + (scaleX + scaleY) / 2;

      if(pinchZoom.obj.oldScale < 1){
        pinchZoom.obj.oldScale = 1;
      }else if (pinchZoom.obj.oldScale > 3){
        pinchZoom.obj.oldScale = 3;
      }

      pinchZoom.el.style.transform = "scale("+pinchZoom.obj.oldScale+")";
    }
  }
  
  pinchZoom.init('#target');
</script>