<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no, address=no, email=no">
<title>MyKia :: MY VEHICLE all car</title>
<link rel="stylesheet" type="text/css" href="../css/morpheus_style.css">
<script type="text/javascript" src="../js/mcore.min.js"></script>
</head>
<body id="mk_a00_0004">
<!-- ========== Start ========== -->    
    
<div id="wrapper">
    <header id="header" class="f_popup">
        <h1><!-- MY VEHICLE --><script type="text/javascript">M.locale.localizedWrite("B1_18")</script></h1>
    </header>

	<section id="container" class="fix-bottom">
		<div id="scroll">
        <!-- contents_Start -->
            
			<div class="car_list">
	            <strong class="desc"><!--The list of Vehicle that in owned by yours-->
	            	<script type="text/javascript">M.locale.localizedWrite("B1_26")</script>
	            </strong>
	            <!-- mycar_list -->
	            <ul class="list_type_select" id="list">
	                <!--
	                <li>
	                    <input type="radio" id="rd02"/>
	                    <label class="li_sub hbox js" for="rd02">
	                        <p class="flex">New Soul ECO-electric</p>
	                        <img src="../img/car/RP_K3Y.png" alt=""/>
	                    </label>
	                </li>
	                <li>
	                    <input type="radio" id="rd03"/>
	                    <label class="li_sub hbox js" for="rd03">
	                        <p class="flex">New Soul ECO-electric</p>
	                        <img src="../img/car/RP_K3Y.png" alt=""/>
	                    </label>
	                </li>
	                 -->
	            </ul>
	        </div>
	
	        <div class="fix_bottom f_btnArea"><!--no selected car add : class='off' -->
	            <button type="button" class="btn_red off" id="mk_a00_0005" disabled="disabled"><!--Select-->
	            	<script type="text/javascript">M.locale.localizedWrite("B1_4")</script>
	            </button>
	        </div>
            
         <!-- //contents_End -->
	     </div>
	</section>
	
    <footer id="footer">
        <p class="img">KIA, The Power to Surprise.</p>
    </footer>
</div>

<!-- ========== //End ========== -->
</body>
<script type="text/javascript" src="../js/ui/common.js"></script>
<script type="text/javascript">
var gvlBackData=false;

// select button
// 선택 버튼
$("#mk_a00_0005").click(gfnMovePage);
function gfnMovePage(_evt){
	
	// move to next screen if it has redirect parameter from previous screen
	// 이전에 넘어온 데이터가 있는 경우 이동해야할 페이지가 지정되어 있는지 체크 한다.
	if(gvlBackData==false){
		
		// move to main screen with ClearTop if there has not a redirect parameter
		// 페이지가 없는 경우 메인화면으로 클리어탑으로 이동한다
		var page=MApi.param("redirect"),
			hash=MApi.param("hash"),
	        option=Options.Default;
	    if(!page){
	        page="mk_a00_0005";
	        option=Options.ClearTop;
	    }else{
	    	// M.data.global("removeLoadingPage","true");
	    }
	    option.hash = hash;
	    Page.moveToPage(page,option);	
	}else if(gvlBackData){
		
		// go back if there has previous page
		// 이전 페이지가 있는 경우 지정된 페이지로 이동한다.
		MApi.back(this,Options.ModalDown);
	}
}
function gfnInit(){
	var  param=MApi.param()
		,vehicles = LoginManager.getVehiclesInfo().Vehicles
		,str = ''

	// checking previous parameters when landing this screen
	// 최초 진입 시 이전 화면에서 넘어온 데이터가 있는지 확인 한다.
	if(param) gvlBackData=param.backData;
    
    // parse list for users vehicles
    // 현재 로그인한 사용자의 차량 데이터를 가져와서 리스트 형태로 표시한다. 
    for (var i in vehicles) {
    	var myVehicle = vehicles[i]
    	str += '<li data-index="' + i + '">';
    	str += '	<input name="car" type="radio" id="rd' + i + '">';
    	str += '		<label class="li_sub hbox js" for="rd' + i + '">';
    	str += '		<p class="flex">' + myVehicle.VehicleName + '</p>';
    	if (LoginManager.getDetailsInfo().MarketId == 'KMSE' && myVehicle.Licenseplate) {
    		str += '		<span>' + M.locale.localizedString("PN_01") + ' ' + myVehicle.Licenseplate + '</span>';
    	}
    	str += '		<div kme-preload>';
    	if (M.locale.VirtualMode) {
    		str += '			<img src="data:' + myVehicle.VehicleImageExtension + ';base64,' + myVehicle.VehicleImage + '"">';
    	} else {
    		str += '			<img src="' + myVehicle.VehicleImageUrl + '">';
    	}
    	str += '		</div>';
    	str += '	</label>';
    	str += '</li>';
    }
    $("#list").html(str);
    $('[data-index]').on('click', onItemClickListener);
    
    function onItemClickListener(){
        $("#mk_a00_0005").prop("disabled",false);
        $("#mk_a00_0005").removeClass("off");
        MApi.storage(Storage.selectedVehicle,$(this).data("index"));
    }

    // if user already have selected an existing vehicle and check mark appropriate vehicle
    // 기존에 선택된 차량이 있을 경우 해당 차량에 선택표시를 한다
    if(gvlBackData){
    	var selectedIndex=MApi.storage(Storage.selectedVehicle);
    	$("#list > li").eq(selectedIndex).find("input").click();
    }
}

// when landing this screen
// 최초 진입 시
M.onReady(function(e){
	gfnInit();
});
M.onHide(function(e){
	setTimeout(function(){
		$("html").hide();
	},2000);
});
M.onBack=function(){};
</script>
</html>